<div class="container mx-auto px-4 py-8 print-content">
  <!-- Header con botones de acción -->
  <div class="flex justify-between items-center mb-6 no-print">
    <div class="flex items-center">
      <button class="p-2 rounded-full text-[var(--primary-500)] hover:bg-[var(--primary-100)] hover:bg-opacity-10 transition-colors" (click)="regresar()">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
      </button>
      <h1 class="text-2xl font-bold ml-2 text-gray-800">Ficha Técnica de Inventario</h1>
    </div>
    
    <button class="flex items-center px-4 py-2 border border-[var(--primary-500)] text-[var(--primary-500)] rounded-md hover:bg-[var(--primary-500)] hover:text-white transition-colors" (click)="verResumenTicket()">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
      </svg>
      Imprimir ficha
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="py-8 text-center">
    <div class="inline-block h-12 w-12 animate-spin rounded-full border-4 border-[var(--primary-500)] border-t-transparent"></div>
    <p class="mt-4 text-gray-600">Cargando detalles...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="py-8 text-center">
    <div class="flex flex-col items-center">
      <div class="text-red-500 mb-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
      </div>
      <p class="text-red-600 font-medium text-lg">{{error}}</p>
      <button class="mt-4 px-4 py-2 bg-[var(--primary-500)] text-white rounded-md hover:bg-[var(--primary-900)] transition-colors" (click)="regresar()">
        Volver
      </button>
    </div>
  </div>

  <!-- Content -->
  <div *ngIf="!isLoading && !error && item">
    <!-- Cabecera con información clave -->
    <div class="bg-white rounded-lg shadow-md mb-6 overflow-hidden">
      <div class="p-6">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
          <div class="flex-1">
            <div class="flex items-center flex-wrap">
              <span class="text-2xl font-bold text-gray-800">{{item.nombre}}</span>
              <span class="ml-3 px-3 py-1 rounded-full text-xs font-semibold uppercase" 
                    [ngClass]="{
                      'bg-blue-100 text-blue-800': item.tipoMaterial === 'oficina',
                      'bg-green-100 text-green-800': item.tipoMaterial === 'limpieza',
                      'bg-purple-100 text-purple-800': item.tipoMaterial === 'varios'
                    }">
                {{formatTipoMaterial(item.tipoMaterial)}}
              </span>
            </div>
            <div class="mt-1 flex items-center text-gray-600 flex-wrap">
              <span class="font-mono text-sm bg-gray-100 px-2 py-1 rounded">{{item.codigoUbicacion}}</span>
              <span class="mx-2 hidden md:inline">|</span>
              <span class="mt-1 md:mt-0">Creado: {{item.fechaCreacion | date:'dd/MM/yyyy HH:mm'}}</span>
              <span *ngIf="item.ultimaModificacion" class="mx-2 hidden md:inline">|</span>
              <span *ngIf="item.ultimaModificacion" class="mt-1 md:mt-0">
                Actualizado: {{item.fechaActualizacion | date:'dd/MM/yyyy HH:mm'}}
              </span>
            </div>
          </div>
          
          <div class="mt-4 md:mt-0 md:ml-4 flex flex-col items-end">
            <div class="px-4 py-2 rounded-full font-medium text-center" 
                 [ngClass]="{
                   'bg-red-100 text-red-800': getStockStatus() === 'agotado',
                   'bg-amber-100 text-amber-800': getStockStatus() === 'critico',
                   'bg-blue-100 text-blue-800': getStockStatus() === 'bajo',
                   'bg-green-100 text-green-800': getStockStatus() === 'optimo'
                 }">
              {{getStockStatusText()}}
            </div>
            <span class="mt-2 text-2xl font-bold">
              {{item.cantidad}}
              <span class="text-gray-600 text-sm font-normal">{{formatUnidadMedida(item.unidadMedida)}}</span>
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Contenido principal con dos columnas -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Columna de información general -->
      <div class="col-span-1">
        <!-- Información básica -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 mb-6 overflow-hidden">
          <div class="bg-gray-50 border-b border-gray-200 px-4 py-3 flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-[var(--primary-500)] mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <h2 class="text-[var(--primary-900)] font-medium">Información General</h2>
          </div>
          <div class="p-4">
            <div class="mb-4">
              <div class="text-sm font-medium text-gray-500 mb-1">Descripción</div>
              <div class="text-gray-800">{{item.descripcion || 'No hay descripción disponible'}}</div>
            </div>
            
            <div class="mb-4">
              <div class="text-sm font-medium text-gray-500 mb-1">Tipo de material</div>
              <div class="text-gray-800">{{formatTipoMaterial(item.tipoMaterial)}}</div>
            </div>
            
            <div class="mb-4">
              <div class="text-sm font-medium text-gray-500 mb-1">Unidad de medida</div>
              <div class="text-gray-800">{{formatUnidadMedida(item.unidadMedida)}}</div>
            </div>
            
            <div class="mb-4">
              <div class="text-sm font-medium text-gray-500 mb-1">Precio unitario</div>
              <div class="text-gray-800">{{item.precioUnitario | currency:'MXN':'symbol':'1.2-2'}}</div>
            </div>
            
            <div class="pt-2 border-t border-gray-100">
              <div class="text-sm font-medium text-gray-500 mb-1">Valor total en inventario</div>
              <div class="text-gray-800 font-medium text-lg">{{item.precioUnitario! * item.cantidad | currency:'MXN':'symbol':'1.2-2'}}</div>
            </div>
          </div>
        </div>
        
        <!-- Ubicación -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 mb-6 overflow-hidden">
          <div class="bg-gray-50 border-b border-gray-200 px-4 py-3 flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-[var(--primary-500)] mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <h2 class="text-[var(--primary-900)] font-medium">Ubicación</h2>
          </div>
          <div class="p-4">
            <div class="p-3 rounded-lg mb-4" 
                [ngClass]="{'bg-blue-50': item.ubicacion.edificio === 'TI', 'bg-green-50': item.ubicacion.edificio === 'ADM'}">
              <div class="text-lg font-medium" 
                  [ngClass]="{'text-blue-700': item.ubicacion.edificio === 'TI', 'text-green-700': item.ubicacion.edificio === 'ADM'}">
                {{item.ubicacion.edificio === 'ADM' ? 'Administración' : 'Tecnologías de la Información'}}
              </div>
              <div class="mt-1 text-gray-600">
                <div class="flex items-center">
                  <span class="w-20 inline-block">Anaquel:</span>
                  <span class="font-medium">{{item.ubicacion.anaquel}}</span>
                </div>
                <div class="flex items-center">
                  <span class="w-20 inline-block">Nivel:</span>
                  <span class="font-medium">{{item.ubicacion.nivel}}</span>
                </div>
                <div *ngIf="item.ubicacion.observaciones" class="mt-2">
                  <span class="font-medium">Observaciones:</span>
                  <span class="italic block mt-1 pl-2 border-l-2 border-gray-200">{{item.ubicacion.observaciones}}</span>
                </div>
              </div>
            </div>
            <div class="text-xs text-gray-500 flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />
              </svg>
              <span class="font-mono">{{item.codigoUbicacion}}</span>
            </div>
          </div>
        </div>
        
        <!-- Información de Stock -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
          <div class="bg-gray-50 border-b border-gray-200 px-4 py-3 flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-[var(--primary-500)] mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
            <h2 class="text-[var(--primary-900)] font-medium">Control de Stock</h2>
          </div>
          <div class="p-4">
            <div class="flex justify-between items-center mb-2">
              <div class="text-sm font-medium text-gray-500">Cantidad actual</div>
              <div class="font-bold text-xl">{{item.cantidad}}</div>
            </div>
            
            <div class="flex justify-between items-center mb-2">
              <div class="text-sm font-medium text-gray-500">Stock mínimo</div>
              <div>{{item.stockMinimo}}</div>
            </div>
            
            <div class="flex justify-between items-center mb-4">
              <div class="text-sm font-medium text-gray-500">Estado</div>
              <div class="px-3 py-1 rounded-full text-xs font-semibold" 
                  [ngClass]="{
                    'bg-red-100 text-red-800': getStockStatus() === 'agotado',
                    'bg-amber-100 text-amber-800': getStockStatus() === 'critico',
                    'bg-blue-100 text-blue-800': getStockStatus() === 'bajo',
                    'bg-green-100 text-green-800': getStockStatus() === 'optimo'
                  }">
                {{getStockStatusText()}}
              </div>
            </div>
            
            <div class="w-full h-2 bg-gray-200 rounded-full overflow-hidden">
              <div class="h-full transition-all duration-300" 
                  [ngClass]="{
                    'bg-red-500': getStockStatus() === 'agotado',
                    'bg-amber-500': getStockStatus() === 'critico',
                    'bg-blue-500': getStockStatus() === 'bajo',
                    'bg-green-500': getStockStatus() === 'optimo'
                  }"
                  [style.width.%]="item.stockMinimo! > 0 ? (item.cantidad / (item.stockMinimo! * 3) * 100) : 100">
              </div>
            </div>
            
            <div class="mt-3 text-xs text-gray-500 italic">
              <div *ngIf="item.stockMinimo! > 0 && item.cantidad <= item.stockMinimo!" class="flex items-center text-amber-700">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                </svg>
                Se recomienda reponer stock pronto
              </div>
              <div *ngIf="item.stockMinimo! > 0 && item.cantidad > item.stockMinimo! * 2" class="flex items-center text-green-700">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                Nivel de stock óptimo
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Columna de contenido principal -->
      <div class="col-span-1 lg:col-span-2">
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
          <!-- Tabs de navegación -->
          <div class="border-b border-gray-200">
            <nav class="flex -mb-px">
              <button (click)="activeTabIndex = 0" class="px-6 py-3 font-medium text-sm border-b-2 transition-colors duration-150 flex items-center" 
                  [ngClass]="activeTabIndex === 0 ? 'border-[var(--primary-500)] text-[var(--primary-900)]' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                </svg>
                Historial de Cambios
              </button>
              <button (click)="activeTabIndex = 1" class="px-6 py-3 font-medium text-sm border-b-2 transition-colors duration-150 flex items-center" 
                  [ngClass]="activeTabIndex === 1 ? 'border-[var(--primary-500)] text-[var(--primary-900)]' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4" />
                </svg>
                Entradas
              </button>
              <button (click)="activeTabIndex = 2" class="px-6 py-3 font-medium text-sm border-b-2 transition-colors duration-150 flex items-center" 
                  [ngClass]="activeTabIndex === 2 ? 'border-[var(--primary-500)] text-[var(--primary-900)]' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                </svg>
                Salidas
              </button>
            </nav>
          </div>
          
          <!-- Contenido de cada tab -->
          <div class="p-4">
            <!-- Tab de Auditoría -->
            <div *ngIf="activeTabIndex === 0">
              <div class="mb-4 flex justify-between items-center">
                <h3 class="text-lg font-medium text-[var(--primary-900)]">Historial de Auditoría</h3>
                <div class="text-sm text-gray-500">
                  {{historialAuditoria.length}} registros encontrados
                </div>
              </div>
              
              <div class="border rounded-lg overflow-hidden">
                <div *ngFor="let evento of historialAuditoria" class="border-b last:border-0 p-4">
                  <div class="flex flex-wrap items-center mb-2">
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium mr-2 mb-1"
                          [ngClass]="{
                            'bg-green-100 text-green-800': evento.tipo === 'CREACIÓN',
                            'bg-blue-100 text-blue-800': evento.tipo === 'MODIFICACIÓN',
                            'bg-purple-100 text-purple-800': evento.tipo === 'ENTRADA',
                            'bg-orange-100 text-orange-800': evento.tipo === 'SALIDA'
                          }">
                      <svg *ngIf="evento.tipo === 'CREACIÓN'" xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                      </svg>
                      <svg *ngIf="evento.tipo === 'MODIFICACIÓN'" xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                      </svg>
                      <svg *ngIf="evento.tipo === 'ENTRADA'" xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                      </svg>
                      <svg *ngIf="evento.tipo === 'SALIDA'" xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                      </svg>
                      {{evento.tipo}}
                    </span>
                    <span class="text-gray-500 text-sm mb-1">
                      {{evento.fecha | date:'dd/MM/yyyy HH:mm'}}
                    </span>
                  </div>
                  <div class="flex items-center mb-1 text-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                    <span class="font-medium">{{evento.usuario}}</span>
                  </div>
                  <div class="text-gray-600 mt-1">
                    {{evento.detalles}}
                  </div>
                </div>
                
                <div *ngIf="historialAuditoria.length === 0" class="py-8 text-center text-gray-500">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-3 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                  </svg>
                  No hay registros de auditoría disponibles
                </div>
              </div>
            </div>
            
            <!-- Tab de Entradas (Usando Angular Material para la tabla) -->
            <div *ngIf="activeTabIndex === 1">
              <div class="mb-4 flex flex-col md:flex-row md:justify-between md:items-center">
                <div class="flex items-center">
                  <h3 class="text-lg font-medium text-[var(--primary-900)] mb-2 md:mb-0">Registro de Entradas</h3>
                  <!-- Indicador de carga pequeño -->
                  <div *ngIf="entradasLoading" class="ml-3 inline-block h-4 w-4 animate-spin rounded-full border-2 border-[var(--primary-500)] border-t-transparent"></div>
                  <!-- Contador de registros -->
                  <span *ngIf="!entradasLoading && entradasTotalItems > 0" class="ml-3 text-sm text-gray-500">
                    {{entradasTotalItems}} {{ entradasTotalItems === 1 ? 'registro' : 'registros' }}
                  </span>
                </div>
                
                <div class="relative">
                  <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                    </svg>
                  </div>
                  <input 
                    type="text" 
                    (keyup)="aplicarFiltroEntradas($event)" 
                    placeholder="Buscar por proveedor, usuario..." 
                    #inputEntradas
                    class="block w-full md:w-64 pl-10 pr-9 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:border-[var(--primary-500)] focus:ring-1 focus:ring-[var(--primary-500)] transition duration-150 ease-in-out sm:text-sm"
                  >
                  <!-- Botón para limpiar búsqueda -->
                  <button *ngIf="entradasFilterValue" 
                          (click)="limpiarFiltroEntradas()" 
                          class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                  </button>
                </div>
              </div>
              
              <!-- Indicador de carga principal -->
              <div *ngIf="entradasLoading" class="flex justify-center items-center py-8">
                <div class="inline-block h-8 w-8 animate-spin rounded-full border-4 border-[var(--primary-500)] border-t-transparent"></div>
                <p class="ml-2 text-gray-600">Cargando entradas...</p>
              </div>
              
              <div class="overflow-x-auto rounded-lg border" [hidden]="entradasLoading">
                <!-- Tabla de entradas existente... -->
                <table mat-table [dataSource]="entradasDataSource" matSort #entradasSort="matSort" class="w-full whitespace-nowrap">
                  <!-- Columnas existentes... -->
                  
                  <!-- Fecha - Cambiar el formato para que sea más legible -->
                  <ng-container matColumnDef="fecha">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header class="bg-gray-50 text-gray-700">Fecha</th>
                    <td mat-cell *matCellDef="let entrada">
                      <div class="font-medium">{{entrada.fecha | date:'dd/MM/yyyy'}}</div>
                      <div class="text-xs text-gray-500">{{entrada.fecha | date:'HH:mm'}}</div>
                    </td>
                  </ng-container>
                  
                  <!-- Cantidad - Agregar un estilo más visual -->
                  <ng-container matColumnDef="cantidad">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header class="bg-gray-50 text-gray-700">Cantidad</th>
                    <td mat-cell *matCellDef="let entrada" class="font-medium text-green-600">
                      <div class="flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                        </svg>
                        {{entrada.cantidad}}
                      </div>
                    </td>
                  </ng-container>
                  
                  <!-- Proveedor -->
                  <ng-container matColumnDef="proveedor">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header class="bg-gray-50 text-gray-700">Proveedor</th>
                    <td mat-cell *matCellDef="let entrada">{{entrada.proveedor || '-'}}</td>
                  </ng-container>

                  <!-- Ubicación -->
                  <!-- <ng-container matColumnDef="ubicacion">
                    <th mat-header-cell *matHeaderCellDef class="bg-gray-50 text-gray-700">Ubicación</th>
                    <td mat-cell *matCellDef="let entrada">
                      <div *ngIf="entrada.ubicacionAnterior && entrada.ubicacionNueva" class="text-xs">
                        <div class="line-through text-gray-400">
                          {{getUbicacionString(entrada.ubicacionAnterior)}}
                        </div>
                        <div class="font-medium text-green-600">
                          {{getUbicacionString(entrada.ubicacionNueva)}}
                        </div>
                      </div>
                      <span *ngIf="!entrada.ubicacionAnterior || !entrada.ubicacionNueva">-</span>
                    </td>
                  </ng-container> -->
                  
                  <!-- Registrado Por -->
                  <ng-container matColumnDef="registradoPor">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header class="bg-gray-50 text-gray-700">Registrado por</th>
                    <td mat-cell *matCellDef="let entrada">
                      <div class="flex items-center" 
                           matTooltip="Entrada registrada el {{entrada.fecha | date:'dd/MM/yyyy HH:mm'}}"
                           matTooltipPosition="above">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                        </svg>
                        <span>{{entrada.registradoPor?.usuario?.username || '-'}}</span>
                      </div>
                    </td>
                  </ng-container>
                  
                  <tr mat-header-row *matHeaderRowDef="displayedColumnsEntradas"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumnsEntradas;"></tr>
                  
                  <!-- Mensaje sin resultados -->
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell py-4 text-center text-gray-500" [attr.colspan]="displayedColumnsEntradas.length">
                      <div *ngIf="inputEntradas.value">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mx-auto mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                        No se encontraron entradas que coincidan con "{{inputEntradas.value}}"
                      </div>
                      <div *ngIf="!inputEntradas.value && entradasDataSource.data.length === 0">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mx-auto mb-2 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M17 16v2a2 2 0 01-2 2H5a2 2 0 01-2-2v-7a2 2 0 012-2h2m3-4H9a2 2 0 00-2 2v7a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-1m-1 4l-3 3m0 0l-3-3m3 3V3" />
                        </svg>
                        No hay registros de entradas disponibles
                      </div>
                    </td>
                  </tr>
                </table>
              </div>
              
              <!-- Mostrar contador de registros debajo de la tabla -->
              <div *ngIf="!entradasLoading && entradasDataSource.data.length > 0" class="text-xs text-gray-500 mt-2 mb-2 pl-2">
                Mostrando {{entradasDataSource.data.length}} de {{entradasTotalItems}} registros
              </div>
              
              <!-- Paginador -->
              <mat-paginator #entradasPaginator
                [length]="entradasTotalItems"
                [pageSize]="entradasPageSize"
                [pageSizeOptions]="[5, 10, 25, 100]"
                [pageIndex]="entradasCurrentPage"
                showFirstLastButtons
                aria-label="Seleccionar página de entradas"
                class="border-t-0 shadow-none"
                [disabled]="entradasLoading">
              </mat-paginator>
            </div>
            
            <!-- Tab de Salidas (Usando Angular Material para la tabla) -->
            <div *ngIf="activeTabIndex === 2">
              <div class="mb-4 flex flex-col md:flex-row md:justify-between md:items-center">
                <h3 class="text-lg font-medium text-[var(--primary-900)] mb-2 md:mb-0">Registro de Salidas</h3>
                
                <div class="relative">
                  <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                    </svg>
                  </div>
                  <input 
                    type="text" 
                    (keyup)="aplicarFiltroSalidas($event)" 
                    placeholder="Buscar..." 
                    #inputSalidas
                    class="block w-full md:w-64 pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:border-[var(--primary-500)] focus:ring-1 focus:ring-[var(--primary-500)] transition duration-150 ease-in-out sm:text-sm"
                  >
                </div>
              </div>
              
              <div class="overflow-x-auto rounded-lg border">
                <table mat-table [dataSource]="salidasDataSource" matSort #salidasSort="matSort" class="w-full whitespace-nowrap">
                  
                  <!-- Fecha -->
                  <ng-container matColumnDef="fecha">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header class="bg-gray-50 text-gray-700">Fecha</th>
                    <td mat-cell *matCellDef="let salida">
                      <div>{{salida.fecha | date:'dd/MM/yyyy'}}</div>
                      <div class="text-xs text-gray-500">{{salida.hora}}</div>
                    </td>
                  </ng-container>
                  
                  <!-- Cantidad -->
                  <ng-container matColumnDef="cantidad">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header class="bg-gray-50 text-gray-700">Cantidad</th>
                    <td mat-cell *matCellDef="let salida" class="font-medium text-red-600">-{{salida.cantidad}}</td>
                  </ng-container>
                  
                  <!-- Área -->
                  <ng-container matColumnDef="area">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header class="bg-gray-50 text-gray-700">Área</th>
                    <td mat-cell *matCellDef="let salida">
                      <div class="text-xs">{{salida.area}}</div>
                      <div *ngIf="salida.motivo" class="text-xs text-gray-500 mt-1 italic">
                        Motivo: {{salida.motivo}}
                      </div>
                    </td>
                  </ng-container>
                  
                  <!-- Solicitante -->
                  <ng-container matColumnDef="solicitante">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header class="bg-gray-50 text-gray-700">Solicitante</th>
                    <td mat-cell *matCellDef="let salida">{{salida.solicitante}}</td>
                  </ng-container>
                  
                  <!-- Motivo -->
                  <!-- <ng-container matColumnDef="motivo">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header class="bg-gray-50 text-gray-700">Motivo</th>
                    <td mat-cell *matCellDef="let salida">{{salida.motivo || '-'}}</td>
                  </ng-container> -->
                  
                  <!-- Registrado Por -->
                  <ng-container matColumnDef="registradoPor">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header class="bg-gray-50 text-gray-700">Registrado por</th>
                    <td mat-cell *matCellDef="let salida">
                      <div class="flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                        </svg>
                        <span>{{salida.registradoPor?.usuario?.username || '-'}}</span>
                      </div>
                    </td>
                  </ng-container>
                  
                  <tr mat-header-row *matHeaderRowDef="displayedColumnsSalidas"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumnsSalidas;"></tr>
                  
                  <!-- Mensaje sin resultados -->
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell py-4 text-center text-gray-500" [attr.colspan]="displayedColumnsSalidas.length">
                      <div *ngIf="inputSalidas.value">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mx-auto mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                        No se encontraron salidas que coincidan con "{{inputSalidas.value}}"
                      </div>
                      <div *ngIf="!inputSalidas.value && salidasDataSource.data.length === 0">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mx-auto mb-2 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                        </svg>
                        No hay registros de salidas disponibles
                      </div>
                    </td>
                  </tr>
                </table>
              </div>
              
              <mat-paginator #salidasPaginator
                [length]="salidasTotalItems"
                [pageSize]="salidasPageSize"
                [pageSizeOptions]="[5, 10, 25, 100]"
                [pageIndex]="salidasCurrentPage"
                showFirstLastButtons
                aria-label="Seleccionar página de salidas"
                class="border-t-0 shadow-none">
              </mat-paginator>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Sección de metadatos y auditoría -->
    <div class="mt-6 text-xs text-gray-500 no-print border-t pt-4 border-gray-200">
      <div *ngIf="item.creador && item.creador.usuario" class="flex items-center mb-1">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
        </svg>
        <strong>Creado por:</strong> <span class="ml-1">{{item.creador.usuario.username || 'Usuario desconocido'}} el {{item.fechaCreacion | date:'dd/MM/yyyy HH:mm'}}</span>
      </div>
      <div *ngIf="item.ultimaModificacion && item.ultimaModificacion.usuario" class="flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
        </svg>
        <strong>Última modificación por:</strong> <span class="ml-1">{{item.ultimaModificacion.usuario.username || 'Usuario desconocido'}} el {{item.fechaActualizacion | date:'dd/MM/yyyy HH:mm'}}</span>
      </div>
    </div>
  </div>
</div>
